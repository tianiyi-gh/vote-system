import{d as a,r as e,l as t,o as s,c as i,b as l,w as n,F as r,g as d,t as c,j as o,f as v,m as u,u as p,h as m,i as g,k as h,n as k,e as y}from"./index-bee774cb.js";import{s as f,_ as w}from"./_plugin-vue_export-helper-2404cc8e.js";const I={class:"candidate-page"},_={key:0,class:"loading-wrapper"},b={class:"candidate-header"},V={class:"candidate-info"},x={class:"candidate-meta"},N={class:"candidate-no"},C={class:"group-name"},T={class:"vote-stats"},F={class:"stats-item"},z={class:"stats-value"},L={class:"stats-item"},S={class:"stats-value"},j={class:"stats-item"},$={class:"stats-value"},D={class:"section-card"},M={class:"candidate-desc"},P={class:"section-card"},E={class:"progress-text"},q={class:"section-card"},A={class:"ranking-list"},B={class:"ranking-number"},G={key:1},H={class:"candidate-name"},J={class:"candidate-votes"},K={key:2,class:"error-state"},O={key:3,class:"vote-button"},Q=w(a({__name:"Candidate",setup(a){const w=u(),Q=p(),R=e(!0),U=e(),W=e(),X=e([]),Y=t(()=>W.value&&1===W.value.status),Z=()=>{Q.push(`/vote/${w.params.serviceId}`)},aa=async(a,e)=>(await new Promise(a=>setTimeout(a,500)),{id:e,activityId:1,serviceId:a,candidateNo:"001",name:"张村",groupName:"第一组",description:"张村位于山东省东部，是一个美丽的乡村。这里山清水秀，风景如画，有着悠久的历史和深厚的文化底蕴。村里的居民热情好客，保留了传统的农耕文化和民俗风情。近年来，张村大力发展生态旅游，建设了多个旅游景点，吸引了众多游客前来观光。村里还注重环境保护，积极开展垃圾分类和污水治理工作，努力打造宜居宜业的美丽乡村。",photo:"https://via.placeholder.com/300x250",totalVotes:1234,ranking:1,status:0,createTime:"2024-12-01 10:00:00"}),ea=async a=>({id:1,serviceId:a,title:"最美乡村评选",subtitle:"寻找我们身边的美丽乡村",region:"山东",status:1,startTime:"2025-01-01 00:00:00",endTime:"2025-12-31 23:59:59",totalVotes:12345,candidateCount:10}),ta=async(a,e)=>(await new Promise(a=>setTimeout(a,300)),[{id:1,activityId:1,serviceId:a,candidateNo:"001",name:"张村",groupName:"第一组",photo:"https://via.placeholder.com/40",totalVotes:1234,ranking:1,status:0,createTime:"2024-12-01 10:00:00"},{id:2,activityId:1,serviceId:a,candidateNo:"002",name:"李村",groupName:"第一组",photo:"https://via.placeholder.com/40",totalVotes:987,ranking:2,status:0,createTime:"2024-12-02 11:00:00"},{id:3,activityId:1,serviceId:a,candidateNo:"003",name:"王村",groupName:"第二组",photo:"https://via.placeholder.com/40",totalVotes:654,ranking:3,status:0,createTime:"2024-12-03 12:00:00"}]),sa=()=>{if(!X.value.length)return 0;const a=Math.max(...X.value.map(a=>a.totalVotes));return Math.round(U.value.totalVotes/a*100)},ia=()=>{if(1===U.value.ranking)return"-";const a=X.value[U.value.ranking-2];if(!a)return"-";return(a.totalVotes-U.value.totalVotes).toLocaleString()+"票"},la=a=>({1:"warning",2:"success",3:"info"}[a]||"");return s(()=>{(async()=>{try{const{serviceId:a,candidateId:e}=w.params;U.value=await aa(a,parseInt(e)),U.value&&(W.value=await ea(a),X.value=await ta(a,10))}catch(a){f("加载失败")}finally{R.value=!1}})()}),(a,e)=>{const t=m("van-nav-bar"),s=m("van-loading"),u=m("van-image"),p=m("van-tag"),f=m("van-progress"),w=m("van-button");return g(),i("div",I,[l(t,{title:"候选人详情","left-arrow":"",onClickLeft:e[0]||(e[0]=e=>a.$router.back()),fixed:""}),R.value?(g(),i("div",_,[l(s,{size:"24px",vertical:""},{default:n(()=>[...e[2]||(e[2]=[h("加载中...",-1)])]),_:1})])):U.value?(g(),i(r,{key:1},[d("div",b,[l(u,{src:U.value.photo||"/default-avatar.png",width:"100%",height:"250",fit:"cover"},null,8,["src"]),d("div",V,[d("h1",null,c(U.value.name),1),d("div",x,[l(p,{type:la(U.value.ranking),size:"large"},{default:n(()=>[h(" 第"+c(U.value.ranking)+"名 ",1)]),_:1},8,["type"]),d("span",N,"编号: "+c(U.value.candidateNo),1),d("span",C,c(U.value.groupName),1)]),d("div",T,[d("div",F,[d("div",z,c(U.value.totalVotes.toLocaleString()),1),e[3]||(e[3]=d("div",{class:"stats-label"},"总票数",-1))]),e[6]||(e[6]=d("div",{class:"stats-divider"},null,-1)),d("div",L,[d("div",S,c(sa())+"%",1),e[4]||(e[4]=d("div",{class:"stats-label"},"得票率",-1))]),e[7]||(e[7]=d("div",{class:"stats-divider"},null,-1)),d("div",j,[d("div",$,c(ia()),1),e[5]||(e[5]=d("div",{class:"stats-label"},"与前一名差距",-1))])])])]),d("div",D,[e[8]||(e[8]=d("h3",null,"个人简介",-1)),d("div",M,c(U.value.description||"暂无简介信息"),1)]),d("div",P,[e[9]||(e[9]=d("h3",null,"投票进度",-1)),l(f,{percentage:sa(),color:(Q=U.value.ranking,{1:"#FFD700",2:"#C0C0C0",3:"#CD7F32"}[Q]||"#409EFF"),"stroke-width":"8","pivot-text":""},null,8,["percentage","color"]),d("div",E," 当前票数: "+c(U.value.totalVotes.toLocaleString()),1)]),d("div",q,[e[11]||(e[11]=d("h3",null,"实时排名",-1)),d("div",A,[(g(!0),i(r,null,o(X.value,(a,t)=>(g(),i("div",{key:a.id,class:k(["ranking-item",{"current-candidate":a.id===U.value.id,"top-three":t<3}])},[d("div",B,[t<3?(g(),y(p,{key:0,type:la(t+1),size:"small"},{default:n(()=>[h(c(t+1),1)]),_:2},1032,["type"])):(g(),i("span",G,c(t+1),1))]),l(u,{src:a.photo||"/default-avatar.png",width:"40",height:"40",fit:"cover",round:""},null,8,["src"]),d("div",H,[h(c(a.name)+" ",1),a.id===U.value.id?(g(),y(p,{key:0,type:"danger",size:"small"},{default:n(()=>[...e[10]||(e[10]=[h(" 我 ",-1)])]),_:1})):v("",!0)]),d("div",J,c(a.totalVotes.toLocaleString())+"票",1)],2))),128))])]),e[12]||(e[12]=d("div",{class:"section-card"},[d("h3",null,"投票趋势"),d("div",{class:"trend-chart"},[d("div",{class:"trend-placeholder"}," 投票趋势图表（开发中...） ")])],-1))],64)):(g(),i("div",K,[l(u,{src:"/error-image.png",class:"error-image"}),e[14]||(e[14]=d("div",{class:"error-text"},"候选人不存在",-1)),l(w,{type:"primary",onClick:e[1]||(e[1]=e=>a.$router.back())},{default:n(()=>[...e[13]||(e[13]=[h("返回",-1)])]),_:1})])),U.value&&Y.value?(g(),i("div",O,[l(w,{type:"danger",size:"large",onClick:Z},{default:n(()=>[h(" 为 "+c(U.value.name)+" 投票 ",1)]),_:1})])):v("",!0)]);var Q}}}),[["__scopeId","data-v-846434b8"]]);export{Q as default};
